#!/bin/r-base
args <- commandArgs()

refined_ms2psmcfa <- function(ms_output= args[1], frag_length = args[2], bin_size = args[3]){
  nr_bins= frag_length/bin_size
  psmcfa_vector <- rep("T", times= nr_bins)

  for (i in seq(from= 1, to = length(ms_output))) {
    k_pos <- ms_output[i]*frag_length
    psmcfa_vector[k_pos] = "K"
  }
  print(paste(psmcfa_vector, collapse = ""))
}

#msout_string <- "0.000197 0.000249 0.000294 0.000309 0.000338 0.000397 0.000415 0.000494 0.000790 0.000843 0.000928 0.001003 0.001050 0.001099 0.001150 0.001408 0.001418 0.001533 0.001636 0.001646 0.001672 0.001681 0.001693 0.001705 0.001725 0.001839 0.001896 0.001951 0.001959 0.002020 0.002029 0.002072 0.002145 0.002213 0.002229 0.002233 0.002268 0.002270 0.002279 0.002389 0.002527 0.002558 0.002791 0.002850 0.002890 0.002926 0.003001 0.003024 0.003093 0.003187 0.003220 0.003231 0.003234 0.004263 0.004491 0.004769 0.005350 0.005791 0.006030 0.006749 0.007571 0.008013 0.008190 0.009003 0.010312 0.010336 0.010414 0.010443 0.010520 0.010534 0.010549 0.010558 0.010614 0.010714 0.010850 0.010883 0.011089 0.011118 0.011127 0.011147 0.011200 0.011240 0.011270 0.011444 0.011495 0.011501 0.011560 0.011620 0.011640 0.011755 0.011758 0.011814 0.011841 0.011846 0.011864 0.011893 0.011899 0.011931 0.012098 0.012356 0.012357 0.012397 0.012469 0.012536 0.012546 0.012643 0.012728 0.012893 0.012942 0.012951 0.012957 0.012974 0.013136 0.013259 0.013264 0.013295 0.013884 0.014084 0.014189 0.014245 0.014438"
#msout_vector <- strsplit(msout_string, split = " ")
msout_vector

refined_ms2psmcfa(msout_vector, 1000000, 100)
msout_vector[1]
